/* ===== Material Design 3 Dark Theme ===== */
:root{
  /* Superficie e sfondi */
  --md-surface-dim: #111318;
  --md-surface: #161B22;
  --md-surface-bright: #1C2128;
  --md-surface-container-lowest: #0B1117;
  --md-surface-container-low: #191E25;
  --md-surface-container: #1D2329;
  --md-surface-container-high: #272C34;
  --md-surface-container-highest: #32373F;

  /* Colori del testo */
  --md-on-surface: #E6EDF3;
  --md-on-surface-variant: #C9D1D9;
  --md-on-surface-muted: #8B949E;
  --md-on-surface-subtle: #656D76;

  /* Outline e divisori */
  --md-outline: #30363D;
  --md-outline-variant: #21262D;

  /* Stati interattivi */
  --md-state-hover: rgba(255,255,255,0.08);
  --md-state-pressed: rgba(255,255,255,0.12);
  --md-state-focus: rgba(255,255,255,0.12);
  --md-state-drag: rgba(255,255,255,0.16);

  /* Shadow elevations */
  --md-shadow-1: 0px 1px 2px 0px rgba(0,0,0,0.3), 0px 1px 3px 1px rgba(0,0,0,0.15);
  --md-shadow-2: 0px 1px 2px 0px rgba(0,0,0,0.3), 0px 2px 6px 2px rgba(0,0,0,0.15);
  --md-shadow-3: 0px 1px 3px 0px rgba(0,0,0,0.3), 0px 4px 8px 3px rgba(0,0,0,0.15);
  --md-shadow-4: 0px 2px 3px 0px rgba(0,0,0,0.3), 0px 6px 10px 4px rgba(0,0,0,0.15);
  --md-shadow-5: 0px 4px 4px 0px rgba(0,0,0,0.3), 0px 8px 12px 6px rgba(0,0,0,0.15);

  /* accent dinamico (settato via JS) */
  --accent: #4FC3F7;
  --accent-container: #0D47A1;
  --on-accent: #001D36;
  --on-accent-container: #B3E5FC;

  /* Layout */
  --header-height: 80px;
  --border-radius-sm: 8px;
  --border-radius-md: 12px;
  --border-radius-lg: 16px;
  --border-radius-xl: 20px;
  --border-radius-full: 9999px;

  /* Typography scale */
  --type-display-large: 57px;
  --type-display-medium: 45px;
  --type-display-small: 36px;
  --type-headline-large: 32px;
  --type-headline-medium: 28px;
  --type-headline-small: 24px;
  --type-title-large: 22px;
  --type-title-medium: 16px;
  --type-title-small: 14px;
  --type-label-large: 14px;
  --type-label-medium: 12px;
  --type-label-small: 11px;
  --type-body-large: 16px;
  --type-body-medium: 14px;
  --type-body-small: 12px;

  --sidebar-width: 360px;          /* Larghezza sidebar */
  --sidebar-header-height: 56px;   /* Altezza testata sidebar */
  --breadcrumbs-height: 48px;      /* Altezza breadcrumbs */
  --gap: 16px;
}

/* ===== Reset & Base ===== */
*{box-sizing:border-box; margin:0; padding:0}

html,body{height:100%; scroll-behavior: smooth;}

body{
  color:var(--md-on-surface);
  background: linear-gradient(135deg, var(--md-surface-dim) 0%, var(--md-surface) 100%);
  font: var(--type-body-medium)/1.5 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, system-ui, sans-serif;
  padding-top: var(--header-height);
  min-height: 100vh;
   overflow: hidden;
}

/* ===== Header migliorato ===== */
header{
  position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
  background: var(--md-surface-container);
  border-bottom: 1px solid var(--md-outline);
  backdrop-filter: saturate(180%) blur(20px);
  box-shadow: var(--md-shadow-2);
  height: var(--header-height);
}

.header-container{
  max-width: 1440px; margin: 0 auto; height: 100%;
  display: flex; align-items: center; padding: 0 24px; gap: 24px;
}

.header-brand{
  display: flex; align-items: center; gap: 12px; flex-shrink: 0;
}

.header-brand h1{
  font-size: var(--type-title-large); font-weight: 600;
  color: var(--md-on-surface); letter-spacing: -0.5px;
  background: linear-gradient(135deg, var(--accent) 0%, var(--on-accent-container) 100%);
  -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
}

.header-icon{
  width: 32px; height: 32px; border-radius: var(--border-radius-sm);
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent-container) 100%);
  display: flex; align-items: center; justify-content: center;
  color: var(--on-accent); font-weight: bold; font-size: 18px;
}

.header-search{
  flex: 1; display: flex; gap: 12px; align-items: center; max-width: 600px;
}

.search-input-wrapper{
  flex: 1; position: relative;
}

.search-input{
  width: 100%; height: 48px; border-radius: var(--border-radius-xl);
  background: var(--md-surface-container-high);
  border: 1px solid var(--md-outline);
  color: var(--md-on-surface); font-size: var(--type-body-medium);
  padding: 0 16px 0 48px; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.search-input:focus{
  outline: none; border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.12);
  background: var(--md-surface-container-highest);
}

.search-input::placeholder{ color: var(--md-on-surface-muted); }

.search-icon{
  position: absolute; left: 16px; top: 50%; transform: translateY(-50%);
  width: 20px; height: 20px; color: var(--md-on-surface-muted);
  pointer-events: none;
}

.header-actions{
  display: flex; gap: 8px; align-items: center;
}

/* Pulsanti migliorati */
.btn{
  display: inline-flex; align-items: center; justify-content: center; gap: 8px;
  height: 40px; padding: 0 16px; border-radius: var(--border-radius-full);
  background: var(--md-surface-container-high);
  border: 1px solid var(--md-outline);
  color: var(--md-on-surface);
  font-size: var(--type-label-large); font-weight: 500;
  cursor: pointer; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative; overflow: hidden;
}

.btn:hover{
  background: var(--md-surface-container-highest);
  border-color: var(--md-outline-variant);
  box-shadow: var(--md-shadow-1);
  transform: translateY(-1px);
}

.btn:active{
  transform: translateY(0px) scale(0.98);
}

.btn-primary{
  background: var(--accent);
  border-color: var(--accent);
  color: var(--on-accent);
}

.btn-primary:hover{
  background: color-mix(in srgb, var(--accent) 85%, white);
  border-color: color-mix(in srgb, var(--accent) 85%, white);
}

/* ===== Layout principale ===== */
.main-container{
  position: fixed;
  top: var(--header-height);
  left: 0; right: 0; bottom: 0;
  margin: 0 auto; padding: 32px 24px;
  overflow: hidden; /* evita doppio scroll; delega ai figli */
  /*max-width: 1440px;*/ /*larghezza massima finestra*/
}

/* Griglia principale: 2 colonne (sidebar | contenuto) Ã— 2 righe (breadcrumbs | tools) */
.layout{
  display: grid;
  grid-template-columns: var(--sidebar-width) 1fr;
  grid-template-rows: var(--breadcrumbs-height) 1fr;
  gap: var(--gap);
  height: 100%;
  min-height: 0; /* fondamentale per overflow interno */
  align-items: stretch;
  flex-direction: column;
}

@media (max-width: 1100px){
  .layout{ grid-template-columns: 300px 1fr; }
}
@media (max-width: 900px){
  .layout{ grid-template-columns: 260px 1fr; }
}


/* ===== Sidebar migliorata ===== */
.sidebar{
  background: var(--md-surface-container);
  border: 1px solid var(--md-outline);
  border-radius: var(--border-radius-xl);
  box-shadow: var(--md-shadow-2);

  max-height: calc(100vh - var(--header-height) - 64px);
  position: sticky;
  top: 0;
  height: 100vh;
  overflow-y: auto;
}

.sidebar-header{
  padding: 20px 24px; border-bottom: 1px solid var(--md-outline);
  background: var(--md-surface-container-high);
  display: flex; justify-content: space-between; align-items: center;
}

.sidebar-title{
  font-size: var(--type-title-medium); font-weight: 600;
  color: var(--md-on-surface);
}

.sidebar-controls{
  display: flex; gap: 8px;
}

.sidebar-controls .btn{
  height: 32px; padding: 0 12px; font-size: var(--type-label-small);
}

.tree-container{
  padding: 16px;
  display: block; /* previene eventuali display:none da media-query precedenti */
  flex: 1 1 auto;
  min-height: 0;
  overflow: auto;
  -webkit-overflow-scrolling: touch;

}

/* ===== Tree navigation migliorata ===== */
.tree ul{
  list-style: none; margin: 0; padding: 0;
}

.tree li{
  margin: 4px 0; position: relative;
}

.tree ul ul{
  margin-left: 24px; padding-left: 16px;
  border-left: 2px solid var(--md-outline-variant);
}

.tree-row{
  display: flex; align-items: center; gap: 12px;
  padding: 10px 12px; border-radius: var(--border-radius-md);
  cursor: pointer; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative; overflow: hidden;
}

.tree-row:hover{
  background: var(--md-state-hover);
}

.tree-row:active{
  background: var(--md-state-pressed);
  transform: scale(0.98);
}

.tree-caret{
  width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;
  color: var(--md-on-surface-muted); transition: transform 0.2s ease;
}

.tree li.expanded > .tree-row .tree-caret{
  transform: rotate(90deg);
}

.tree-label{
  flex: 1; font-size: var(--type-body-small); font-weight: 500;
  color: var(--md-on-surface);
}

.tree-count{
  font-size: var(--type-label-small); color: var(--md-on-surface-muted);
  background: var(--md-surface-container-highest);
  padding: 2px 8px; border-radius: var(--border-radius-full);
  min-width: 24px; text-align: center;
}

/* Stati attivi tree */
.tree li.active > .tree-row{
  background: color-mix(in srgb, var(--accent) 12%, transparent);
  border: 1px solid color-mix(in srgb, var(--accent) 40%, transparent);
  color: var(--accent);
}

.tree li.active > .tree-row .tree-label{
  color: var(--accent); font-weight: 600;
}

.tree li.ancestor > .tree-row{
  background: color-mix(in srgb, var(--accent) 6%, transparent);
}

/* ===== Content area ===== */
.content-area{
  min-height: 60vh;
}

.breadcrumbs{
  font-family: 'JetBrains Mono', Consolas, monospace;
  font-size: var(--type-body-small); color: var(--md-on-surface-muted);
  margin-bottom: 24px; padding: 12px 16px;
  background: var(--md-surface-container);
  border: 1px solid var(--md-outline);
  border-radius: var(--border-radius-md);
  grid-column: 2 / 3;
  grid-row: 1 / 2;
  height: var(--breadcrumbs-height);
  display: flex;
  align-items: center;
  gap: 8px;
  padding-inline: 8px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  z-index: 900; /* sopra al contenuto */
}

/* ===== Cards grid migliorata ===== */
.tools-grid{
  min-height: 100%;
  display: grid; gap: 20px;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
}

@media (max-width: 768px){
  .tools-grid{ grid-template-columns: 1fr; }
}

.tool-card{
  background: var(--md-surface-container);
  border: 1px solid var(--md-outline);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--md-shadow-1);
  padding: 20px; position: relative; overflow: hidden;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: pointer;
}

.tool-card:hover{
  transform: translateY(-4px);
  box-shadow: var(--md-shadow-4);
  border-color: var(--md-outline-variant);
}

.tool-card.active{
  border-color: var(--accent);
  box-shadow: 0 0 0 1px var(--accent), var(--md-shadow-3);
  background: color-mix(in srgb, var(--accent) 3%, var(--md-surface-container));
}

.tool-header{
  display: flex; align-items: flex-start; gap: 16px; margin-bottom: 16px;
}

.tool-star{
  font-size: 24px; color: #FFD700; flex-shrink: 0;
  text-shadow: 0 0 8px rgba(255, 215, 0, 0.3);
}

.tool-info{
  flex: 1; min-width: 0;
}

.tool-title{
  font-size: var(--type-title-medium); font-weight: 600;
  color: var(--md-on-surface); margin-bottom: 8px;
  display: flex; align-items: center; gap: 12px;
}

.tool-meta{
  display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px;
}

.tool-badge{
  padding: 4px 12px; border-radius: var(--border-radius-full);
  font-size: var(--type-label-small); font-weight: 600;
  text-transform: uppercase; letter-spacing: 0.5px;
}

.tool-badge.web{
  background: linear-gradient(135deg, #4FC3F7 0%, #29B6F6 100%);
  color: #001D36;
}
.tool-badge.infrastructure{
  background: linear-gradient(135deg, #81C784 0%, #66BB6A 100%);
  color: #1B5E20;
}
.tool-badge.both{
  background: linear-gradient(135deg, #BA68C8 0%, #AB47BC 100%);
  color: #4A148C;
}

.tool-caps{
  display: flex; flex-wrap: wrap; gap: 6px;
}

.tool-cap{
  background: var(--md-surface-container-high);
  border: 1px solid var(--md-outline);
  color: var(--md-on-surface-variant);
  padding: 3px 8px; border-radius: var(--border-radius-sm);
  font-size: var(--type-label-small);
}

.tool-description{
  color: var(--md-on-surface-variant);
  font-size: var(--type-body-small); line-height: 1.5;
  margin-bottom: 16px;
}

.tool-path{
  font-family: 'JetBrains Mono', Consolas, monospace;
  font-size: var(--type-label-small); color: var(--md-on-surface-muted);
  margin-bottom: 16px; padding: 8px;
  background: var(--md-surface-container-highest);
  border-radius: var(--border-radius-sm);
}

.tool-actions{
  display: flex; justify-content: space-between; align-items: center;
  border-top: 1px solid var(--md-outline-variant); padding-top: 16px;
}

.tool-repo{
  color: var(--accent); text-decoration: none; font-weight: 500;
  display: flex; align-items: center; gap: 6px;
  transition: color 0.2s ease;
}

.tool-repo:hover{
  color: color-mix(in srgb, var(--accent) 80%, white);
}

.tool-notes-btn{
  padding: 6px 12px; height: auto; font-size: var(--type-label-small);
}

/* ===== Modal per le note ===== */
.modal-overlay{
  position: fixed; top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px);
  z-index: 2000; display: none; align-items: center; justify-content: center;
  padding: 20px; animation: fadeIn 0.2s ease;
}

.modal-overlay.show{
  display: flex;
}

@keyframes fadeIn{
  from{ opacity: 0; }
  to{ opacity: 1; }
}

.modal{
  background: var(--md-surface-container);
  border: 1px solid var(--md-outline);
  border-radius: var(--border-radius-xl);
  box-shadow: var(--md-shadow-5);
  width: 100%; max-width: 800px; max-height: 90vh;
  display: flex; flex-direction: column;
  animation: modalIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes modalIn{
  from{ opacity: 0; transform: scale(0.9) translateY(-10px); }
  to{ opacity: 1; transform: scale(1) translateY(0); }
}

.modal-header{
  padding: 24px; border-bottom: 1px solid var(--md-outline);
  display: flex; justify-content: space-between; align-items: center;
  background: var(--md-surface-container-high);
  border-radius: 20px 20px 0 0;
}

.modal-title{
  font-size: var(--type-title-large); font-weight: 600;
  color: var(--md-on-surface);
}

.modal-close{
  width: 40px; height: 40px; border-radius: var(--border-radius-full);
  background: transparent; border: 1px solid var(--md-outline);
  color: var(--md-on-surface-muted); cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.2s ease;
}

.modal-close:hover{
  background: var(--md-state-hover);
  border-color: var(--md-outline-variant);
}

.modal-body{
  flex: 1; overflow: hidden; display: flex; flex-direction: column;
}

.modal-tabs{
  display: flex; border-bottom: 1px solid var(--md-outline);
  background: var(--md-surface-container-high);
}

.modal-tab{
  padding: 16px 24px; background: none; border: none;
  color: var(--md-on-surface-muted); cursor: pointer;
  font-size: var(--type-label-large); font-weight: 500;
  transition: all 0.2s ease;
  position: relative;
}

.modal-tab.active{
  color: var(--accent);
}

.modal-tab.active::after{
  content: ''; position: absolute; bottom: 0; left: 0; right: 0;
  height: 3px; background: var(--accent); border-radius: 2px 2px 0 0;
}

.modal-content{
  flex: 1; overflow: hidden; position: relative;
}

.tab-panel{
  display: none; height: 650px; flex-direction: column;
}

.tab-panel.active{
  display: flex;
}

.notes-editor{
  flex: 1;
  border: none;
  resize: none;
  background: var(--md-surface); color: var(--md-on-surface);
  font-family: 'JetBrains Mono', Consolas, monospace;
  font-size: var(--type-body-small); line-height: 1.6;
  padding: 24px;
}

.notes-editor:focus{
  outline: none;
}

.notes-preview{
  flex: 1; overflow-y: auto; padding: 24px;
  background: var(--md-surface);
}

.modal-footer{
  padding: 24px; border-top: 1px solid var(--md-outline);
  display: flex; justify-content: flex-end; gap: 12px;
  background: var(--md-surface-container-high);
  border-radius: 0 0 20px 20px;
}

/* ===== Stili per il contenuto markdown ===== */
.markdown-content h1,
.markdown-content h2,
.markdown-content h3,
.markdown-content h4,
.markdown-content h5,
.markdown-content h6{
  color: var(--md-on-surface); margin: 16px 0 12px;
}

.markdown-content p{
  color: var(--md-on-surface-variant); margin: 12px 0; line-height: 1.6;
}

.markdown-content code{
  background: var(--md-surface-container-high);
  color: var(--accent); padding: 2px 6px;
  border-radius: var(--border-radius-sm);
  font-family: 'JetBrains Mono', Consolas, monospace;
}

.markdown-content pre{
  background: var(--md-surface-container-high);
  border: 1px solid var(--md-outline);
  border-radius: var(--border-radius-md);
  padding: 16px; overflow-x: auto; margin: 16px 0;
}

.markdown-content pre code{
  background: none; padding: 0;
}

.markdown-content blockquote{
  border-left: 4px solid var(--accent);
  background: var(--md-surface-container-high);
  padding: 16px; margin: 16px 0;
  color: var(--md-on-surface-variant);
}

.markdown-content ul,
.markdown-content ol{
  padding-left: 24px; margin: 12px 0;
  color: var(--md-on-surface-variant);
}

.markdown-content li{
  margin: 6px 0;
}

/* ===== Back to top & Empty state ===== */
.back-to-top{
  position: fixed; right: 32px; bottom: 32px; z-index: 1500;
  width: 45px; height: 45px; border-radius: var(--border-radius-full);
  background: var(--accent); color: var(--on-accent);
  border: none; cursor: pointer; box-shadow: var(--md-shadow-3);
  display: none; align-items: center; justify-content: center;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  opacity: 0;
  pointer-events: none;
}

#back-to-top, #backToTop, .backToTop, .scroll-top, [data-back-to-top]{
  position: fixed;
  right: 32px;
  bottom: 32px;
  z-index: 1500;
  display: none;
  opacity: 0;
  pointer-events: none;
}
#back-to-top.show, #backToTop.show, .back-to-top.show, .backToTop.show, .scroll-top.show, [data-back-to-top].show{
  display: flex;
  opacity: 1;
  pointer-events: auto;
}

.back-to-top:hover{
  transform: translateY(-2px);
  box-shadow: var(--md-shadow-4);
}

.empty-state{
  text-align: center; padding: 80px 40px;
  color: var(--md-on-surface-muted);
  border: 2px dashed var(--md-outline);
  border-radius: var(--border-radius-lg);
  background: var(--md-surface-container-low);
}

.empty-state h3{
  font-size: var(--type-title-medium); margin-bottom: 12px;
  color: var(--md-on-surface-variant);
}

/* ===== Utilities ===== */
.sr-only{
  position: absolute; width: 1px; height: 1px; padding: 0;
  margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0);
  white-space: nowrap; border: 0;
}

/* ===== Ripple effect ===== */
.ripple{
  position: absolute; border-radius: 50%; transform: scale(0);
  animation: ripple 0.6s ease-out; background: rgba(255,255,255,0.3);
  pointer-events: none;
}

@keyframes ripple{
  to{ transform: scale(4); opacity: 0; }
}

/* ===== Focus styles ===== */
:focus-visible{
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* ===== Responsive ===== */
@media (max-width: 768px){
  .header-container{ padding: 0 16px; }
  .main-container{ padding: 16px; }
  .layout{ gap: 16px; }
  .tool-card{ padding: 16px; }
}

/* Version badge */
.tool-badge.version{
  background: linear-gradient(135deg, #C0C6CF, #9AA6B2);
  color: #0A0F14;
}
/* Tree stable scrollbar */
.tree-container{ scrollbar-gutter: stable; overscroll-behavior: contain; }
.tree-container::-webkit-scrollbar{ width:10px; }
.tree-container::-webkit-scrollbar-thumb{ background:#9aa6b2; border-radius:8px; }

/* ===== Contenuto scrollabile (solo i tool) ===== */
.tools-scroll{
  grid-column: 2 / 3;
  grid-row: 2 / 3;
  min-height: 0;                 /* abilita overflow nelle griglie */
  overflow: auto;                /* <-- scorre solo qui */
  -webkit-overflow-scrolling: touch;
  padding-right: 8px;            /* evita che la scrollbar copra i contenuti */
  padding-top: 8px;
}

/* Evidenzia i conteggi durante la ricerca */
.tree-count.highlight {
  background: var(--accent);
  color: white;
  font-weight: 600;
  padding: 2px 8px;
  border-radius: 12px;
  min-width: 24px;
  text-align: center;
}

/* Riduce l'opacitÃ  delle sezioni senza risultati durante la ricerca */
li.no-results > .tree-row {
  opacity: 0.4;
  transition: opacity 0.2s ease;
}

li.no-results > .tree-row:hover {
  opacity: 0.7;
}

/* Evidenzia le sezioni con risultati durante la ricerca */
li.has-results > .tree-row .tree-label {
  font-weight: 600;
}

/* Assicura che le sezioni rimangano sempre interattive */
.tree-row {
  cursor: pointer;
  pointer-events: auto;
}